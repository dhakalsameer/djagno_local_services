{% extends "base.html" %} {% block content %}

<div class="bg-white p-6 rounded shadow max-w-3xl mx-auto">
  <!-- SERVICE INFO -->
  <h1 class="text-3xl font-bold mb-2">{{ service.title }}</h1>

  <p class="text-gray-600 mb-1">ğŸ“ {{ service.location }}</p>
  <p class="text-gray-600 mb-3">ğŸ‘¤ Provider: {{ service.provider.username }}</p>

  <p class="mb-4">{{ service.description }}</p>

  <p class="font-semibold mb-6">
    ğŸ’° Price: Rs {{ service.price }} ({{ service.price_type }})
  </p>

  <!-- BOOK BUTTON (CUSTOMER ONLY) -->
  {% if user.is_authenticated %} {% if user.profile.role == 'customer' %}
  <a
    href="{% url 'book_service' service.id %}"
    class="bg-blue-600 text-white px-5 py-2 rounded hover:bg-blue-700"
  >
    ğŸ“… Book This Service
  </a>
  {% endif %} {% else %}
  <a href="{% url 'login' %}" class="bg-blue-600 text-white px-5 py-2 rounded">
    Login to Book
  </a>
  {% endif %}

  <!-- REVIEWS -->
  <h3 class="text-xl font-semibold mt-8 mb-3">â­ Reviews</h3>

  {% for review in service.reviews.all %}
  <div class="bg-gray-100 p-3 mb-3 rounded">
    <strong>â­ {{ review.rating }}/5</strong><br />
    {{ review.comment }}<br />
    <small class="text-gray-600"> â€” {{ review.customer.username }} </small>
  </div>
  {% empty %}
  <p class="text-gray-500">No reviews yet.</p>
  {% endfor %}

  <!-- ADD REVIEW (ONLY AFTER COMPLETED BOOKING) -->
{% if can_review %}
<a
  href="{% url 'add_review' service.id %}"
  class="inline-block mt-4 text-blue-600 hover:underline"
>
  âœï¸ Add Review
</a>
{% endif %}
{% if user.is_authenticated and user.profile.role == 'customer' and not can_review %}
<p class="text-sm text-gray-500 mt-3">
  You can add a review after the service is completed.
</p>
{% endif %}

</div>

{% endblock %}
